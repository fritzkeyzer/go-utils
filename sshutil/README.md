<!-- Code generated by gomarkdoc. DO NOT EDIT -->

# sshutil

```go
import "github.com/fritzkeyzer/go-utils/sshutil"
```

## Index

- [Variables](<#variables>)
- [func AddKnownHost(host string, remote net.Addr, key ssh.PublicKey, knownFile string) (err error)](<#func-addknownhost>)
- [func CheckKnownHost(host string, remote net.Addr, key ssh.PublicKey, knownFile string) (found bool, err error)](<#func-checkknownhost>)
- [func DefaultKnownHosts() (ssh.HostKeyCallback, error)](<#func-defaultknownhosts>)
- [func DefaultKnownHostsPath() (string, error)](<#func-defaultknownhostspath>)
- [func Dial(proto string, c *Config) (*ssh.Client, error)](<#func-dial>)
- [func GetSigner(prvKey string, passphrase string) (ssh.Signer, error)](<#func-getsigner>)
- [func HasAgent() bool](<#func-hasagent>)
- [func KnownHosts(file string) (ssh.HostKeyCallback, error)](<#func-knownhosts>)
- [type Auth](<#type-auth>)
  - [func Key(prvkey string, passphrase string) (Auth, error)](<#func-key>)
  - [func Password(pass string) Auth](<#func-password>)
  - [func UseAgent() (Auth, error)](<#func-useagent>)
- [type Client](<#type-client>)
  - [func New(user string, addr string, auth Auth) (c *Client, err error)](<#func-new>)
  - [func NewConn(config *Config) (c *Client, err error)](<#func-newconn>)
  - [func NewUnknown(user string, addr string, auth Auth) (*Client, error)](<#func-newunknown>)
  - [func (c Client) Close() error](<#func-client-close>)
  - [func (c Client) Command(name string, args ...string) (*Cmd, error)](<#func-client-command>)
  - [func (c Client) CommandContext(ctx context.Context, name string, args ...string) (*Cmd, error)](<#func-client-commandcontext>)
  - [func (c Client) Download(remotePath string, localPath string) (err error)](<#func-client-download>)
  - [func (c Client) NewSftp(opts ...sftp.ClientOption) (*sftp.Client, error)](<#func-client-newsftp>)
  - [func (c Client) Run(cmd string) ([]byte, error)](<#func-client-run>)
  - [func (c Client) RunContext(ctx context.Context, name string) ([]byte, error)](<#func-client-runcontext>)
  - [func (c Client) Upload(localPath string, remotePath string) (err error)](<#func-client-upload>)
- [type Cmd](<#type-cmd>)
  - [func (c *Cmd) CombinedOutput() ([]byte, error)](<#func-cmd-combinedoutput>)
  - [func (c *Cmd) Output() ([]byte, error)](<#func-cmd-output>)
  - [func (c *Cmd) Run() error](<#func-cmd-run>)
  - [func (c *Cmd) Start() error](<#func-cmd-start>)
  - [func (c *Cmd) String() string](<#func-cmd-string>)
- [type Config](<#type-config>)


## Variables

DefaultTimeout is the timeout of ssh client connection.

```go
var DefaultTimeout = 20 * time.Second
```

## func AddKnownHost

```go
func AddKnownHost(host string, remote net.Addr, key ssh.PublicKey, knownFile string) (err error)
```

AddKnownHost add a a host to known hosts file.

## func CheckKnownHost

```go
func CheckKnownHost(host string, remote net.Addr, key ssh.PublicKey, knownFile string) (found bool, err error)
```

CheckKnownHost checks is host in known hosts file. it returns is the host found in known\_hosts file and error, if the host found in known\_hosts file and error not nil that means public key mismatch, maybe MAN IN THE MIDDLE ATTACK\! you should not handshake.

## func DefaultKnownHosts

```go
func DefaultKnownHosts() (ssh.HostKeyCallback, error)
```

DefaultKnownHosts returns host key callback from default known hosts path, and error if any.

## func DefaultKnownHostsPath

```go
func DefaultKnownHostsPath() (string, error)
```

DefaultKnownHostsPath returns default user knows hosts file.

## func Dial

```go
func Dial(proto string, c *Config) (*ssh.Client, error)
```

Dial starts a client connection to SSH server based on config.

## func GetSigner

```go
func GetSigner(prvKey string, passphrase string) (ssh.Signer, error)
```

GetSigner returns ssh signer from private key file.

## func HasAgent

```go
func HasAgent() bool
```

HasAgent checks if ssh agent exists.

## func KnownHosts

```go
func KnownHosts(file string) (ssh.HostKeyCallback, error)
```

KnownHosts returns host key callback from a custom known hosts path.

## type Auth

Auth represents ssh auth methods.

```go
type Auth []ssh.AuthMethod
```

### func Key

```go
func Key(prvkey string, passphrase string) (Auth, error)
```

Key returns auth method from private key with or without passphrase.

### func Password

```go
func Password(pass string) Auth
```

Password returns password auth method.

### func UseAgent

```go
func UseAgent() (Auth, error)
```

UseAgent auth via ssh agent, \(Unix systems only\)

## type Client

Client represents Goph client.

```go
type Client struct {
    *ssh.Client
    Config *Config
}
```

### func New

```go
func New(user string, addr string, auth Auth) (c *Client, err error)
```

New starts a new ssh connection, the host public key must be in known hosts.

### func NewConn

```go
func NewConn(config *Config) (c *Client, err error)
```

NewConn returns new client and error if any.

### func NewUnknown

```go
func NewUnknown(user string, addr string, auth Auth) (*Client, error)
```

NewUnknown starts a ssh connection get client without cheking knownhosts. PLEASE AVOID USING THIS, UNLESS YOU KNOW WHAT ARE YOU DOING\! if there a "man in the middle proxy", this can harm you\! You can add the key to know hosts and use New\(\) func instead\!

### func \(Client\) Close

```go
func (c Client) Close() error
```

Close client net connection.

### func \(Client\) Command

```go
func (c Client) Command(name string, args ...string) (*Cmd, error)
```

Command returns new Cmd and error if any.

### func \(Client\) CommandContext

```go
func (c Client) CommandContext(ctx context.Context, name string, args ...string) (*Cmd, error)
```

Command returns new Cmd with context and error, if any.

### func \(Client\) Download

```go
func (c Client) Download(remotePath string, localPath string) (err error)
```

Download file from remote server\!

### func \(Client\) NewSftp

```go
func (c Client) NewSftp(opts ...sftp.ClientOption) (*sftp.Client, error)
```

NewSftp returns new sftp client and error if any.

### func \(Client\) Run

```go
func (c Client) Run(cmd string) ([]byte, error)
```

Run starts a new SSH session and runs the cmd, it returns CombinedOutput and err if any.

### func \(Client\) RunContext

```go
func (c Client) RunContext(ctx context.Context, name string) ([]byte, error)
```

Run starts a new SSH session with context and runs the cmd. It returns CombinedOutput and err if any.

### func \(Client\) Upload

```go
func (c Client) Upload(localPath string, remotePath string) (err error)
```

Upload a local file to remote server\!

## type Cmd

Cmd it's like os/exec.Cmd but for ssh session.

```go
type Cmd struct {

    // Path to command executable filename
    Path string

    // Command args.
    Args []string

    // Session env vars.
    Env []string

    // SSH session.
    *ssh.Session

    // Context for cancellation
    Context context.Context
}
```

### func \(\*Cmd\) CombinedOutput

```go
func (c *Cmd) CombinedOutput() ([]byte, error)
```

CombinedOutput runs cmd on the remote host and returns its combined stdout and stderr.

### func \(\*Cmd\) Output

```go
func (c *Cmd) Output() ([]byte, error)
```

Output runs cmd on the remote host and returns its stdout.

### func \(\*Cmd\) Run

```go
func (c *Cmd) Run() error
```

Run runs cmd on the remote host.

### func \(\*Cmd\) Start

```go
func (c *Cmd) Start() error
```

Start runs the command on the remote host.

### func \(\*Cmd\) String

```go
func (c *Cmd) String() string
```

String return the command line string.

## type Config

Config for Client.

```go
type Config struct {
    Auth     Auth
    User     string
    Addr     string
    Port     uint
    Timeout  time.Duration
    Callback ssh.HostKeyCallback
}
```



Generated by [gomarkdoc](<https://github.com/princjef/gomarkdoc>)
