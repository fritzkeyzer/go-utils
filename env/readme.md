# env
Is a utility package for loading environment variables into tagged structs.

- `Load(ptr any)`
    - takes a pointer to a struct.
    - For each field tagged with `env:"ENV_NAME"` LoadCfg will attempt to load the environment variable, parse it to the correct type and set the field.
    - If the named env variable isn't found and a 'default' tag is not specified, LoadCfg returns an error.

Additional functions are included:
- `ReplaceVars(input string, ptr any)`
    - Replacing substrings using tagged config structs.
    - Useful for injecting variables into strings.
- `Print(ptr any)`
    - Pretty printing config structs, while obfuscating secret fields.
    - Fields tagged with `secret:"true"` are obfuscated.

<!-- gomarkdoc:embed:start -->

<!-- Code generated by gomarkdoc. DO NOT EDIT -->

# env

```go
import "github.com/fritzkeyzer/go-utils/env"
```

Package env is a utility package for loading environment variables into tagged structs.

## Index

- [func Load(ptr any) error](<#func-load>)
- [func Print(ptr any) string](<#func-print>)
- [func ReplaceVars(input string, ptr any) string](<#func-replacevars>)


## func Load

```go
func Load(ptr any) error
```

Load takes a pointer to a struct.

For each field tagged with \`env\` Load will attempt to load the environment variable, parse it to the correct type and set the field.

If the named env variable isn't found and a 'default' tag is not specified, Load returns an error.

Example struct:

```
type Config struct {
	EnvName    string   `env:"ENV_NAME" default:"dev"`
	SomeSecret string   `env:"SOME_SECRET"`
	SomeSlice  []string `env:"SOME_SLICE" default:"'hello', 'world'"`
}
```

## func Print

```go
func Print(ptr any) string
```

Print dumps the contents of a struct to a formatted string. All fields are include except ones tagged with \`secret:"true"\` Secret fields are printed with asterisks.

<details><summary>Example</summary>
<p>

```go
package main

import (
	"fmt"
	"github.com/fritzkeyzer/go-utils/env"
	"log"
	"os"
)

func main() {
	if err := os.Setenv("SOME_SECRET", "spooky"); err != nil {
		log.Fatalln(err)
	}

	type Config struct {
		EnvName    string   `env:"ENV_NAME" default:"dev"`
		SomeSecret string   `env:"SOME_SECRET" secret:"true"`
		SomeSlice  []string `env:"SOME_SLICE" default:"'hello', 'world'"`
	}

	var cfg Config
	if err := env.Load(&cfg); err != nil {
		log.Fatalf("FATAL: %v", err)
	}

	fmt.Print(env.Print(&cfg))
}
```

#### Output

```
Config:
	EnvName: dev
	SomeSecret: '******' (SECRET)
	SomeSlice: ['hello' 'world']
```

</p>
</details>

## func ReplaceVars

```go
func ReplaceVars(input string, ptr any) string
```

ReplaceVars will replace variables in an input string.

eg:

```
type Config struct {
	Var string `env:"VAR_NAME"`
}
cfg := Config{ Var: "xxx" }
ReplaceVars("var = {VAR_NAME}", &cfg) // result: "var = xxx"
```

<details><summary>Example</summary>
<p>

```go
package main

import (
	"fmt"
	"github.com/fritzkeyzer/go-utils/env"
	"log"
	"os"
)

func main() {
	if err := os.Setenv("SOME_SECRET", "spooky"); err != nil {
		log.Fatalln(err)
	}

	type Config struct {
		EnvName    string   `env:"ENV_NAME" default:"dev"`
		SomeSecret string   `env:"SOME_SECRET" secret:"true"`
		SomeSlice  []string `env:"SOME_SLICE" default:"'hello', 'world'"`
	}

	var cfg Config
	if err := env.Load(&cfg); err != nil {
		log.Fatalf("FATAL: %v", err)
	}

	someExampleString := "environment={ENV_NAME}, secret={SOME_SECRET}"
	replacedString := env.ReplaceVars(someExampleString, &cfg)

	fmt.Print(replacedString)
}
```

#### Output

```
environment=dev, secret=spooky
```

</p>
</details>



Generated by [gomarkdoc](<https://github.com/princjef/gomarkdoc>)


<!-- gomarkdoc:embed:end -->